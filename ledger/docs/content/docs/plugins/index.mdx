---
title: Plugins
description: Extend Ledger Framework with plugins
---

# Plugins

Plugins extend Ledger Framework functionality. They follow the BetterAuth pattern and can hook into services, modify behavior, and add new features.

## Plugins

Ledger Framework includes several built-in plugins:

- **[Validation Plugin](/docs/plugins/validation)** - Validate entries before storage
- **[Webhook Plugin](/docs/plugins/webhook)** - Send webhooks on events
- **[Indexing Plugin](/docs/plugins/indexing)** - Create secondary indexes

## Validation Plugin

Validates ledger entries before they are stored. Throws errors for invalid entries.

See the [Validation Plugin documentation](/docs/plugins/validation) for detailed information.

```typescript
import { createValidationPlugin } from "@onoal/ledger-plugins";

const ledger = createLedger({
  plugins: [
    createValidationPlugin({
      validateProof: (entry) => {
        if (!entry.payload.subject_oid) {
          throw new Error("Proof must have subject_oid");
        }
        if (!entry.payload.issuer_oid) {
          throw new Error("Proof must have issuer_oid");
        }
      },
      validateAsset: (entry) => {
        if (!entry.payload.owner_oid) {
          throw new Error("Asset must have owner_oid");
        }
      },
    }),
  ],
});
```

**Features**:

- Entry validation before storage
- Custom validation rules per entry type
- Type-safe validation functions

## Webhook Plugin

Sends webhooks when ledger entries are created, updated, or deleted.

See the [Webhook Plugin documentation](/docs/plugins/webhook) for detailed information.

```typescript
import { createWebhookPlugin } from "@onoal/ledger-plugins";

const ledger = createLedger({
  plugins: [
    createWebhookPlugin({
      url: "https://api.example.com/webhooks/ledger",
      secret: process.env.WEBHOOK_SECRET,
      retry: {
        maxAttempts: 3,
        delay: 1000,
      },
      onError: (error, event) => {
        console.error("Webhook failed:", error, event);
      },
    }),
  ],
});
```

**Features**:

- Automatic webhook sending
- Retry logic with exponential backoff
- Error handling with callbacks
- Asynchronous (non-blocking)

## Indexing Plugin

Creates secondary indexes for faster lookups.

See the [Indexing Plugin documentation](/docs/plugins/indexing) for detailed information.

```typescript
import { createIndexingPlugin } from "@onoal/ledger-plugins";

const ledger = createLedger({
  plugins: [
    createIndexingPlugin({
      indexByStream: true,
      indexBySubjectOid: true,
      indexByIssuerOid: true,
      indexByType: true,
    }),
  ],
});
```

**Features**:

- Stream-based indexing
- OID-based indexing
- Type-based indexing
- Automatic index maintenance

## Using Plugins

Plugins can be added during ledger creation:

```typescript
// During creation
const ledger = createLedger({
  plugins: [
    createValidationPlugin({ ... }),
    createWebhookPlugin({ ... }),
  ],
});
```

## Creating Custom Plugins

You can create custom plugins by implementing the `OnoalLedgerPlugin` interface:

```typescript
import type { OnoalLedgerPlugin } from "@onoal/ledger-core";

export function myCustomPlugin(): OnoalLedgerPlugin {
  return {
    id: "my-custom",
    label: "My Custom Plugin",
    version: "1.0.0",
    setup: async (ledger) => {
      // Hook into services, modify behavior
      const service = ledger.getService("proofService");
      // ...
    },
  };
}
```

## Next Steps

- [API Server](/docs/api-server) - Expose your ledger via REST API
- [CLI Tool](/docs/cli) - Scaffold new projects
