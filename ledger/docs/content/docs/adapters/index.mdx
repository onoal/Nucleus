---
title: Adapters
description: Database adapters for Ledger Framework
---

# Adapters

Adapters abstract database operations, allowing you to switch between different database backends without changing your code.

## Adapters

Ledger Framework supports multiple database adapters:

- **[SQLite Adapter](/docs/adapters/sqlite)** - Local development and small-scale deployments
- **[PostgreSQL Adapter](/docs/adapters/postgres)** - Production-ready PostgreSQL adapter (Neon serverless)
- **[D1 Adapter](/docs/adapters/d1)** - Cloudflare D1 adapter for edge deployments

## SQLite Adapter

Perfect for development and small-scale deployments. Uses better-sqlite3 with WAL mode.

See the [SQLite Adapter documentation](/docs/adapters/sqlite) for detailed information.

```typescript
import { sqliteAdapter } from "@onoal/ledger-database-sqlite";

const ledger = createLedger({
  adapter: sqliteAdapter({ path: "./ledger.db" }),
});
```

**Use cases**:

- Development
- Testing
- Small-scale deployments
- Single-server deployments

## PostgreSQL Adapter

Production-ready adapter for PostgreSQL (Neon serverless):

```typescript
import { postgresAdapter } from "@onoal/ledger-database-postgres"";

const ledger = createLedger({
  adapter: postgresAdapter({
    connectionString: process.env.DATABASE_URL!,
  }),
});
```

See the [PostgreSQL Adapter documentation](/docs/adapters/postgres) for detailed information.

**Use cases**:

- Production deployments
- Multi-server deployments
- Cloudflare Workers with Neon/Postgres
- High-traffic applications

## D1 Adapter

Cloudflare D1 adapter for edge deployments:

```typescript
import { d1Adapter } from "@onoal/ledger-database-cloudflare-d1";

export default {
  async fetch(request: Request, env: Env): Promise<Response> {
    const ledger = createLedger({
      adapter: d1Adapter(env.DB),
    });
    // ...
  },
};
```

See the [D1 Adapter documentation](/docs/adapters/d1) for detailed information.

**Use cases**:

- Cloudflare Workers deployments
- Edge computing
- Serverless applications
- Global distribution

## Database Schema

All adapters create the same schema:

- `ledger_entries` - Main ledger entries table
- `ledger_tip` - Chain tip tracking
- `ledger_checkpoints` - Chain checkpoints for verification

```sql
CREATE TABLE ledger_entries (
  id TEXT PRIMARY KEY,
  stream TEXT NOT NULL,
  timestamp INTEGER NOT NULL,
  payload TEXT NOT NULL,
  hash TEXT NOT NULL,
  prev_hash TEXT,
  signature TEXT,
  status TEXT NOT NULL DEFAULT 'active',
  meta TEXT,
  created_at INTEGER NOT NULL
);

CREATE TABLE ledger_tip (
  id INTEGER PRIMARY KEY DEFAULT 1,
  entry_id TEXT NOT NULL,
  hash TEXT NOT NULL,
  timestamp INTEGER NOT NULL,
  updated_at INTEGER NOT NULL
);

CREATE TABLE ledger_checkpoints (
  id TEXT PRIMARY KEY,
  timestamp INTEGER NOT NULL,
  root_hash TEXT NOT NULL,
  signature TEXT NOT NULL,
  entries_count INTEGER NOT NULL,
  start_timestamp INTEGER NOT NULL,
  end_timestamp INTEGER NOT NULL,
  created_at INTEGER NOT NULL
);
```

## Migrations

All adapters support programmatic migrations:

```typescript
const adapter = sqliteAdapter({ path: "./ledger.db" });
await adapter.migrate?.();
```

Migrations create tables if they don't exist, so they're safe to run multiple times.

## Performance

- **Indexes**: Automatic indexes on `stream`, `timestamp`, `hash`, and chain columns
- **WAL Mode**: SQLite WAL mode enabled by default for better concurrency
- **Connection Pooling**: PostgreSQL adapter uses connection pooling
- **Edge-Ready**: D1 adapter optimized for Cloudflare Workers

## Creating Custom Adapters

You can create custom adapters by implementing the `LedgerAdapter` interface:

```typescript
import type { LedgerAdapter } from "@onoal/ledger-core";

export function myCustomAdapter(): LedgerAdapter {
  return {
    id: "my-custom",
    provider: "custom",
    db: {
      // Implement LedgerDb interface
    },
    migrate: async () => {
      // Implement migrations
    },
  };
}
```

## Next Steps

- [Modules](/docs/modules) - Explore built-in modules
- [Plugins](/docs/plugins) - Extend functionality
- [API Server](/docs/api-server) - Expose your ledger via REST API
