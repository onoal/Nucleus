---
title: Asset Module
description: Issue and query assets in the ledger
---

# Asset Module

The Asset Module provides asset issuance and querying functionality with automatic asset JWT generation.

## Installation

```bash
pnpm add @onoal/ledger-module-asset
```

## Usage

```typescript
import { createLedger } from "@onoal/ledger-core";
import { assetModule } from "@onoal/ledger-module-asset";

const ledger = createLedger({
  modules: [assetModule()],
  // ...
});
```

## Service

Access the service via the ledger:

```typescript
const service = ledger.getService<AssetService>("assetService");
```

## Methods

### Issue Asset

Creates a new asset in the ledger with automatic asset JWT generation.

```typescript
const result = await service.issueAsset({
  issuer_oid: "oid:onoal:org:festival",
  owner_oid: "oid:onoal:user:alice",
  type: "ticket",
  payload: {
    event: "Summer Festival",
    section: "VIP",
    seat: "A1",
  },
  exp: Math.floor(Date.now() / 1000) + 86400, // 1 day
  meta: {
    source: "ticket_system",
  },
});
```

**Returns**: `{ asset_id: string, ledger_hash: string, asset_jwt: string, ledger_entry_id: string, timestamp: number }`

The returned result includes:
- `asset_id` - Unique asset identifier (UUID)
- `ledger_hash` - Hash of the ledger entry
- `asset_jwt` - Signed JWT containing asset data
- `ledger_entry_id` - ID of the ledger entry
- `timestamp` - Timestamp of issuance

The `asset_jwt` contains:
- Asset metadata (asset_id, issuer_oid, owner_oid, type)
- Asset payload
- Expiration (if provided)
- Ed25519 signature

### Query Assets

Queries assets from the ledger with optional filters.

```typescript
const result = await service.queryAssets({
  owner_oid: "oid:onoal:user:alice",
  issuer_oid: "oid:onoal:org:festival",
  type: "ticket",
  limit: 20,
  cursor: 1234567890,
});
```

**Returns**: `{ entries: LedgerEntry[], nextCursor: number | null, hasMore: boolean }`

**Filters**:
- `owner_oid` - Filter by owner OID
- `issuer_oid` - Filter by issuer OID
- `type` - Filter by asset type
- `status` - Filter by entry status (active, revoked, etc.)
- `limit` - Maximum number of results (default: 50)
- `cursor` - Pagination cursor (timestamp)

### Get Asset

Retrieves an asset entry by ID.

```typescript
const asset = await service.getAsset(entry.id);
```

**Returns**: `LedgerEntry | null`

## Routes

### POST /asset/issue

Issue a new asset to the ledger.

**Request Body**:
```json
{
  "issuer_oid": "oid:onoal:org:festival",
  "owner_oid": "oid:onoal:user:alice",
  "type": "ticket",
  "payload": {
    "event": "Summer Festival",
    "section": "VIP",
    "seat": "A1"
  },
  "exp": 1234567890,
  "meta": {
    "source": "ticket_system"
  }
}
```

**Response**:
```json
{
  "asset_id": "550e8400-e29b-41d4-a716-446655440000",
  "ledger_hash": "hash_123...",
  "asset_jwt": "eyJhbGciOiJFZDI1NTE5In0...",
  "ledger_entry_id": "entry_123...",
  "timestamp": 1234567890
}
```

### GET /asset/:id

Get an asset entry by ID.

**Response**:
```json
{
  "id": "entry_123...",
  "stream": "assets",
  "timestamp": 1234567890,
  "payload": {
    "asset_id": "550e8400-e29b-41d4-a716-446655440000",
    "issuer_oid": "oid:onoal:org:festival",
    "owner_oid": "oid:onoal:user:alice",
    "type": "ticket",
    "payload": {
      "event": "Summer Festival",
      "section": "VIP",
      "seat": "A1"
    },
    "asset_jwt": "eyJhbGciOiJFZDI1NTE5In0...",
    "action": "issued"
  },
  "hash": "hash_123...",
  "prev_hash": "prev_hash_123...",
  "signature": "sig_123...",
  "status": "active",
  "meta": {
    "source": "ticket_system"
  }
}
```

### GET /asset/list

Query assets with filters.

**Query Parameters**:
- `owner_oid` - Filter by owner OID
- `issuer_oid` - Filter by issuer OID
- `type` - Filter by asset type
- `status` - Filter by entry status
- `limit` - Maximum number of results (default: 50)
- `cursor` - Pagination cursor (timestamp)

**Response**:
```json
{
  "assets": [
    {
      "id": "entry_123...",
      "stream": "assets",
      "timestamp": 1234567890,
      "payload": { ... },
      "hash": "hash_123...",
      ...
    }
  ],
  "next_cursor": 1234567891,
  "has_more": true
}
```

## Type Definitions

```typescript
interface IssueAssetOptions {
  issuer_oid: string;
  owner_oid: string;
  type: string;
  payload: Record<string, unknown>;
  meta?: Record<string, unknown>;
  exp?: number; // Optional expiration timestamp (Unix seconds)
}

interface QueryAssetsFilters {
  owner_oid?: string;
  issuer_oid?: string;
  type?: string;
  status?: EntryStatus;
  limit?: number;
  cursor?: number;
}
```

## Next Steps

- [Proof Module](/docs/modules/proof) - Create and query proofs
- [Connect Module](/docs/modules/connect) - Manage connect grants

